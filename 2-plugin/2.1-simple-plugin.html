<script src="../node_modules/vue/dist/vue.js"></script>

<script>
/**
GOAL:
Create a plugin that teaches Vue components to handle a custom "rules"
option. The "rules" option expects an object that specifies validation rules
for data in the component.

Expected usage:

```
const vm = new Vue({
  data: { foo: 10 },
  rules: {
    foo: {
      validate: value => value > 1,
      message: 'foo must be greater than one'
    }
  }
})

vm.foo = 0 // should log: "foo must be greater than one"
```

HINTS:
1. The plugin should install a global mixin
2. The global mixin contains a "created" hook
3. In the hook, check for `this.$options.rules`
*/

const RulesPlugin = {
  install (Vue) {
    Vue.mixin({
      created () {
        const rules = this.$options.rules
        if (rules) {
          Object.keys(rules).forEach(key => {
            const { validate, message } = rules[key]
            this.$watch(key, newValue => {
              const valid = validate(newValue)
              if (!valid) {
                console.log(message)
              }
            })
          })
        }
      }
    })
  }
}

Vue.use(RulesPlugin)
</script>
